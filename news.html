<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beyond Horizon | News</title>
<style>
body { margin:0; font-family:Arial,sans-serif; display:flex; flex-direction:column; min-height:100vh; background:#ffebee;}
nav { background: #b71c1c; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; }
nav .logo a { color:white; font-weight:bold; text-decoration:none; font-size:16px;}
nav .links a { color:white; margin-left:15px; text-decoration:none; font-weight:bold; font-size:14px;}
nav .links a:hover{text-decoration:underline;}
header { background:#f44336; color:white; padding:3rem 2rem; text-align:center; }
header h1 { margin:0; font-size:2.5rem; }
header p { margin-top:0.5rem; font-size:1.2rem; }
.container { padding:2rem; max-width:1000px; margin:auto; flex:1; }
.search-bar { margin-bottom:1rem; display:flex; gap:0.5rem; flex-wrap:wrap;}
.search-bar input, .search-bar select { padding:0.5rem; border-radius:5px; border:1px solid #ccc; flex:1;}
.search-bar button { background:#b71c1c; color:white; padding:0.5rem 1rem; border:none; border-radius:5px; cursor:pointer; font-weight:bold;}
.search-bar button:hover { background:#f44336; }
.article-card { background:white; padding:1.5rem; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); margin-bottom:1rem; cursor:pointer;}
.article-card h2 { margin-top:0; }
.article-card p { margin:0.5rem 0; }
.article-card img { max-width:100%; margin:0.5rem 0; border-radius:5px; }
.image-credit { font-size:0.8rem; color:#555; }
footer { background:#b71c1c; color:white; text-align:center; padding:1rem; margin-top:auto; }
footer a { color:white; margin:0 5px; text-decoration:none; }
footer a:hover { text-decoration:underline; }
</style>
</head>
<body>

<nav>
  <div class="logo"><a href="index.html"><strong>Beyond Horizon</strong></a></div>
  <div class="links">
    <a href="index.html">Home</a>
    <a href="news.html">News</a>
    <a href="sports.html">Sports</a>
    <a href="about.html">About</a>
    <a href="contact.html">Contact</a>
  </div>
</nav>

<header>
  <h1>News</h1>
  <p>Latest News Articles</p>
</header>

<div class="container">

<div class="search-bar">
  <input type="text" id="keyword" placeholder="Search by keyword...">
  <input type="text" id="editorSearch" placeholder="Filter by editor...">
  <button onclick="applyFilter()">Filter</button>
</div>

<div id="articles-container">
  <p>Loading articles...</p>
</div>

</div>

<footer>
<p>&copy; 2025 Beyond Horizon | <a href="terms.html">Terms</a> | <a href="privacy.html">Privacy</a></p>
</footer>

<script>
let allArticles = [];

// Fetch articles from backend
function loadArticles(){
  fetch('get_articles.php?category=news')
    .then(res=>res.json())
    .then(data=>{
      allArticles = data.sort((a,b)=>new Date(b.published_at)-new Date(a.published_at));
      renderArticles(allArticles);
    })
    .catch(err=>{ 
      console.error(err);
      document.getElementById('articles-container').innerHTML='<p>Error loading articles.</p>';
    });
}

function renderArticles(articles){
  const container = document.getElementById('articles-container');
  container.innerHTML='';
  if(articles.length===0){ container.innerHTML='<p>No news articles found.</p>'; return; }

  articles.forEach(article=>{
    const card = document.createElement('div');
    card.className='article-card';
    card.innerHTML = `
      ${article.cover_image ? `<img src="${article.cover_image}" alt="Cover Image">` : ''}
      <h2>${article.title}</h2>
      <p><em>${article.author} | ${new Date(article.published_at).toLocaleString()}</em></p>
      <p>${article.content.substring(0,150)}...</p>
    `;
    // Redirect to single article page (article.html?slug=...)
    card.addEventListener('click', ()=>{ window.location.href=`article.html?slug=${article.slug}`; });
    container.appendChild(card);
  });
}

// Filter functionality
function applyFilter(){
  const keyword=document.getElementById('keyword').value.toLowerCase();
  const editor=document.getElementById('editorSearch').value.toLowerCase();
  const filtered = allArticles.filter(a=> 
    (a.title.toLowerCase().includes(keyword) || a.content.toLowerCase().includes(keyword)) && 
    a.author.toLowerCase().includes(editor)
  );
  renderArticles(filtered);
}

// Initial load
loadArticles();
</script>

</body>
</html>
